!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses"],r):r(n.V={},n.I,n.L)}(this,function(n,c,f){"use strict";function r(n){this.value=void 0!==n?n:null}function a(n){var r=Error(JSON.stringify(n,null,2));return r.errors=n,r}function s(n){throw a(n)}function l(n,r){var t=V;return t===R?t=r:V=R,n.of(g(t))}function u(u){u=f.toFunction(u);for(var n=arguments.length,o=D;--n;){var r=arguments[n];o=1!==i(r)?G(W(r[0]),z(r[1]),o):c.always(z(r[0]))}return function(n,r,t,e){return u(n,r,f.Constant,o)(n,r,t,e)}}var i=function(n){return n.length},y=c.curry(function(n,r){return n<=r}),t=c.curry(function(n,r){return r instanceof n}),e=t(Object),p=c.curry(function(r,t){return function(n){return r(t(n))}}),d=c.curry(function(r,t){return function(n){return r(n)&&t(n)}}),o=function(n){},v=function(n){return n},h=v,m=function(n){return Promise.reject(n)},A=function(n){return Promise.resolve(n)},w=t(r),g=v(function(n){return new r(n)}),j=function(n){return n.value},O=function(n){return w(n)?j(n):void 0},I=function(r,t){return function(n){return f.any(w,r,n)?g(f.modify(r,t,n)):n}},F=f.rewrite(I(f.elems,function(n){return w(n)?j(n):null})),N=f.rewrite(I(f.elems,O)),b=f.rewrite(I(f.values,O)),E=function(n){return w(n)?s(a(j(n))):n},x=function(t,e,u){return h(function(){var n=arguments.length,r=t;if(n)for(r=e(arguments[--n],r);n;)r=u(arguments[--n],r);return r},u)},z=function(n){if(c.isFunction(n))return i(n)<3?tn(n):n;var r=n[1];return c.isFunction(r)?en(r,n[0]):un(r,n[0])},M=function(n,r){return f.ifElse(n,P(r),S)},P=p(f.toFunction,f.modify(f.elems,z)),T=function(n){var r=n.less,e=n.rest;return e=z(e),function(){for(var o=arguments.length,t=Array(o),n=0;n<o;++n)t[n]=z(arguments[n]);return M(r?c.isArray:d(c.isArray,p(y(o),i)),[F,r?function(n,r,t,e){var u=i(n);return u<o?((n=n.slice()).length=o,t.map(function(n){return f.any(w,f.elems,n)?n:n.slice(0,u)},f.elemsTotal(n,r,t,e))):f.elemsTotal(n,r,t,e)}:f.elemsTotal,f.choose(function(n,r){return t[r]||e})])}},q=function(n,r,t){return Q({Monad:n,onAccept:r,onReject:t})},R={},V=R,W=function(t,e){return function(n,r){try{return t(n,r)}catch(n){return V=n,e}}},_=f.zero,k=function(u){return function(n,r,t,e){return e(u,r)}},C=function(u){return function(n,r,t,e){return t.chain(function(n){return e(n,r)},u(n,r))}},J=function(u){return function(n,r,t,e){return t.map(g,u(n,r))}},L=p(f.setOp,g),S=f.modifyOp(g),B=k(void 0),D=c.always(S),G=function(n,c,f){return function(o,i){return function(r,t,e,u){return e.chain(function(n){return n?c(r,t,e,u):void 0!==n||V===R?f(o,i)(r,t,e,u):l(e,r)},n(o,i))}}},H=function(t){return c.curryN(2,h(function(r){return r=z(r),function(n){return n=z(n),t(r,n)}},t))},K=function(r){return function(n){return 3===i(n)?[n[0],an(on(n[1],n[2]),r)]:n}},Q=c.curryN(3,function(n){var t=n.Monad||f.Identity,r=n.onAccept||v,e=n.onReject||s,u=function(n){return w(n)?e(j(n)):r(n)};return function(r){return r=z(r),function(n){return t.chain(u,f.traverse(t,v,r,n))}}}),U=q(0,c.always(!0),c.always(!1)),X=q(0,o,v),Y=q(),Z=q(f.IdentityAsync,c.always(A(!0)),c.always(A(!1))),$=q(f.IdentityAsync,c.always(A()),A),nn=q(f.IdentityAsync,0,p(s,a)),rn=q(f.IdentityAsync,A,p(m,a)),tn=function(u){return u=W(u),function(r,n,t,e){return t.chain(function(n){return n?t.of(r):l(t,r)},u(r,n))}},en=c.curry(function(u,o){return o=z(o),function(r,t,e,n){return e.chain(function(n){return w(n)?e.map(g,u(r,j(n),t)):e.of(n)},o(r,t,e,n))}}),un=c.curry(function(r,n){return P([f.rewrite(function(n){return w(n)?g(r):n}),n])}),on=c.curryN(2,function(n){return p(an(n),C)}),cn=c.curryN(2,function(n){return p(an(n),k)}),fn=function(n){return an(n,B)},an=H(function(u,o){return function(n,r,t,e){return t.chain(function(n){return w(n)?t.of(n):o(n,r,t,e)},u(n,r,t,e))}}),sn=x(_,z,an),ln=function(n){return P([f.setter(function(n,r){return w(n)?r:g(r)}),n])},yn=H(function(n,o){return function(r,t,e,u){return e.chain(function(n){return w(n)?o(r,t,e,u):e.of(n)},n(r,t,e,u))}}),pn=x(S,z,yn),dn=function(n){return M(c.isArray,[N,f.elems,n])},vn=function(n){return M(c.isArray,[F,f.elems,n])},hn=T({less:!0,rest:_}),mn=T({less:!1,rest:S}),An=c.curry(function(o,i){return o=z(o),function(e,n,u,r){return u.of(c.isFunction(e)?h(function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return u.chain(function(r){return w(r)?s(a(j(r))):u.chain(function(n){return u.map(E,f.traverse(u,v,z(i.apply(null,r)),n))},e.apply(null,r))},f.traverse(u,v,o,r))},e):g(e))}}),wn=c.curry(function(n,r){return An(n,c.always(r))}),gn=c.curry(function(o,n){return M(e,[f.setter(function(n,r){return w(n)?g(f.set(o,(t=o,e=j(n),u=r,void 0!==(e=f.get(t,e))?e:f.get(t,u)),j(n))):n;var t,e,u}),n])}),jn=function(n){return P([f.optional,n])},On=c.curry(function(n,r){return M(e,[b,f.branchOr(z(n),f.modify(f.values,z,r))])}),In=On(S),Fn=function(n){return n=W(n),h(function(r,t,e,u){return e.chain(function(n){return n?z(n)(r,t,e,u):l(e,r)},n(r,t))},n)},Nn=x(S,function(n,r){return 1===i(n)?n[0]:bn(n[0],n[1],r)},function(n,r){return bn(n[0],n[1],r)}),bn=c.curry(function(n,o,i){return n=W(n),o=z(o),i=z(i),function(r,t,e,u){return e.chain(function(n){return n?o(r,t,e,u):void 0!==n||V===R?i(r,t,e,u):l(e,r)},n(r,t))}}),En=p(f.lazy,p(z)),xn=function(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];return En(function(r){return pn.apply(null,t.map(function(n){return 2===i(n)?an(on(n[0],n[1]),r):n[0]}))})},zn=function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return En(function(n){return Nn.apply(null,r.map(K(n)))})},Mn=function(r){for(var n=arguments.length,t=Array(1<n?n-1:0),e=1;e<n;e++)t[e-1]=arguments[e];return En(function(n){return u.apply(null,[r].concat(t.map(K(n))))})},Pn=function(n){return n},Tn=Pn(_),qn=Pn(k),Rn=Pn(C),Vn=Pn(J),Wn=Pn(L),_n=Pn(S),kn=Pn(B),Cn=Pn(Q),Jn=Pn(U),Ln=Pn(X),Sn=Pn(Y),Bn=Pn(Z),Dn=Pn($),Gn=Pn(nn),Hn=Pn(rn),Kn=Pn(tn),Qn=Pn(en),Un=Pn(un),Xn=Pn(on),Yn=Pn(cn),Zn=Pn(fn),$n=Pn(an),nr=Pn(sn),rr=Pn(ln),tr=Pn(yn),er=Pn(pn),ur=Pn(dn),or=Pn(vn),ir=Pn(hn),cr=Pn(mn),fr=Pn(An),ar=Pn(wn),sr=Pn(gn),lr=Pn(jn),yr=Pn(On),pr=Pn(In),dr=Pn(Fn),vr=Pn(Nn),hr=Pn(bn),mr=Pn(u),Ar=Pn(En),wr=Pn(xn),gr=Pn(zn),jr=Pn(Mn);n.accept=Tn,n.acceptAs=qn,n.acceptWith=Rn,n.rejectWith=Vn,n.rejectAs=Wn,n.reject=_n,n.remove=kn,n.run=Cn,n.accepts=Jn,n.errors=Ln,n.validate=Sn,n.acceptsAsync=Bn,n.errorsAsync=Dn,n.tryValidateAsyncNow=Gn,n.validateAsync=Hn,n.where=Kn,n.modifyError=Qn,n.setError=Un,n.modifyAfter=Xn,n.setAfter=Yn,n.removeAfter=Zn,n.both=$n,n.and=nr,n.not=rr,n.either=tr,n.or=er,n.arrayId=ur,n.arrayIx=or,n.args=ir,n.tuple=cr,n.dependentFn=fr,n.freeFn=ar,n.keep=sr,n.optional=lr,n.propsOr=yr,n.props=pr,n.choose=dr,n.cases=vr,n.ifElse=hr,n.casesOf=mr,n.lazy=Ar,n.promote=wr,n.upgrades=gr,n.upgradesOf=jr,Object.defineProperty(n,"__esModule",{value:!0})});
