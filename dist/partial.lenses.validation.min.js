!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses"],r):r(n.V={},n.I,n.L)}(this,function(n,r,t){"use strict";function e(n){this.value=void 0!==n?n:null}function u(n){var r=Error(JSON.stringify(n,null,2));return r.errors=n,r}function i(n){throw u(n)}function o(n,r){var t=V;return t===R?t=r:V=R,n.of(g(t))}function c(n){n=t.toFunction(n);for(var e=arguments.length,u=B;--e;){var i=arguments[e];u=1!==f(i)?D(W(i[0]),z(i[1]),u):r.always(z(i[0]))}return function(r,e,i,o){return n(r,e,t.Constant,u)(r,e,i,o)}}var f=function(n){return n.length},a=r.curry(function(n,r){return n<=r}),s=r.curry(function(n,r){return r instanceof n}),l=s(Object),y=r.curry(function(n,r){return function(t){return n(r(t))}}),p=r.curry(function(n,r){return function(t){return n(t)&&r(t)}}),d=Promise,h=d.reject.bind(d),v=d.resolve.bind(d),m=function(n,t){return null!=(e=t)&&r.isFunction(e.then)?t.then(n):n(t);var e},A=(0,r.id)({map:m,ap:function(n,r){return m(function(r){return m(function(n){return n(r)},n)},r)},of:r.id,chain:m}),w=s(e),g=(0,r.id)(function(n){return new e(n)}),j=function(n){return n.value},O=function(n){return w(n)?j(n):void 0},F=function(n,r){return function(e){return t.any(w,n,e)?g(t.modify(n,r,e)):e}},b=t.rewrite(F(t.elems,function(n){return w(n)?j(n):null})),N=t.rewrite(F(t.elems,O)),E=t.rewrite(F(t.values,O)),x=function(n){return w(n)?i(u(j(n))):n},I=function(n,r,t){return function(){var e=arguments.length,u=n;if(e)for(u=r(arguments[--e],u);e;)u=t(arguments[--e],u);return u}},z=function(n){if(r.isFunction(n))return f(n)<3?rn(n):n;var t=n[1];return r.isFunction(t)?tn(t,n[0]):en(t,n[0])},M=function(n,r){return t.ifElse(n,T(r),L)},T=y(t.toFunction,t.modify(t.elems,z)),q=function(n){var e=n.less,u=n.rest;return u=z(u),function(){for(var n=arguments.length,i=Array(n),o=0;o<n;++o)i[o]=z(arguments[o]);return M(e?r.isArray:p(r.isArray,y(a(n),f)),[b,e?function(r,e,u,i){var o=f(r);return o<n?((r=r.slice()).length=n,u.map(function(n){return t.any(w,t.elems,n)?n:n.slice(0,o)},t.elemsTotal(r,e,u,i))):t.elemsTotal(r,e,u,i)}:t.elemsTotal,t.choose(function(n,r){return i[r]||u})])}},P=function(n,r,t){return K({Monad:n,onAccept:r,onReject:t})},R={},V=R,W=function(n,r){return function(t,e){try{return n(t,e)}catch(n){return V=n,r}}},_=t.zero,k=function(n){return function(r,t,e,u){return u(n,t)}},C=function(n){return function(r,t,e,u){return e.chain(function(n){return u(n,t)},n(r,t))}},J=y(t.setOp,g),L=t.modifyOp(g),S=k(void 0),B=r.always(L),D=function(n,r,t){return function(e,u){return function(i,c,f,a){return f.chain(function(n){return n?r(i,c,f,a):void 0!==n||V===R?t(e,u)(i,c,f,a):o(f,i)},n(e,u))}}},G=function(n){return r.curryN(2,function(r){return r=z(r),function(t){return t=z(t),n(r,t)}})},H=function(n){return function(r){return 3===f(r)?[r[0],cn(un(r[1],r[2]),n)]:r}},K=r.curryN(3,function(n){var e=n.Monad||t.Identity,u=n.onAccept||r.id,o=n.onReject||i,c=function(n){return w(n)?o(j(n)):u(n)};return function(n){return n=z(n),function(u){return e.chain(c,t.traverse(e,r.id,n,u))}}}),Q=P(0,r.always(!0),r.always(!1)),U=P(0,function(n){},r.id),X=P(),Y=P(A,r.always(v(!0)),r.always(v(!1))),Z=P(A,r.always(v()),v),$=P(A,0,y(i,u)),nn=P(A,v,y(h,u)),rn=function(n){return n=W(n),function(r,t,e,u){return e.chain(function(n){return n?e.of(r):o(e,r)},n(r,t))}},tn=r.curry(function(n,r){return r=z(r),function(t,e,u,i){return u.chain(function(r){return w(r)?u.map(g,n(t,j(r),e)):u.of(r)},r(t,e,u,i))}}),en=r.curry(function(n,r){return T([t.rewrite(function(r){return w(r)?g(n):r}),r])}),un=r.curryN(2,function(n){return y(cn(n),C)}),on=r.curryN(2,function(n){return y(cn(n),k)}),cn=G(function(n,r){return function(t,e,u,i){return u.chain(function(n){return w(n)?u.of(n):r(n,e,u,i)},n(t,e,u,i))}}),fn=I(_,z,cn),an=G(function(n,r){return function(t,e,u,i){return u.chain(function(n){return w(n)?r(t,e,u,i):u.of(n)},n(t,e,u,i))}}),sn=I(L,z,an),ln=q({less:!0,rest:_}),yn=q({less:!1,rest:L}),pn=r.curry(function(n,e){return n=z(n),function(o,c,f,a){return f.of(r.isFunction(o)?function(){for(var c=arguments.length,a=Array(c),s=0;s<c;s++)a[s]=arguments[s];return f.chain(function(n){return w(n)?i(u(j(n))):f.chain(function(u){return f.map(x,t.traverse(f,r.id,z(e.apply(null,n)),u))},o.apply(null,n))},t.traverse(f,r.id,n,a))}:g(o))}}),dn=r.curry(function(n,t){return pn(n,r.always(t))}),hn=r.curry(function(n,r){return M(l,[t.setter(function(r,e){return w(r)?g(t.set(n,function(n,r,e){return void 0!==(r=t.get(n,r))?r:t.get(n,e)}(n,j(r),e),j(r))):r}),r])}),vn=r.curry(function(n,r){return M(l,[E,t.branchOr(z(n),t.modify(t.values,z,r))])}),mn=vn(L),An=I(L,function(n,r){return 1===f(n)?n[0]:wn(n[0],n[1],r)},function(n,r){return wn(n[0],n[1],r)}),wn=r.curry(function(n,r,t){return n=W(n),r=z(r),t=z(t),function(e,u,i,c){return i.chain(function(n){return n?r(e,u,i,c):void 0!==n||V===R?t(e,u,i,c):o(i,e)},n(e,u))}}),gn=y(t.lazy,y(z)),jn=function(n){return n},On=jn(_),Fn=jn(k),bn=jn(C),Nn=jn(function(n){return function(r,t,e,u){return e.map(g,n(r,t))}}),En=jn(J),xn=jn(L),In=jn(S),zn=jn(K),Mn=jn(Q),Tn=jn(U),qn=jn(X),Pn=jn(Y),Rn=jn(Z),Vn=jn($),Wn=jn(nn),_n=jn(rn),kn=jn(tn),Cn=jn(en),Jn=jn(un),Ln=jn(on),Sn=jn(function(n){return cn(n,S)}),Bn=jn(cn),Dn=jn(fn),Gn=jn(function(n){return T([t.setter(function(n,r){return w(n)?r:g(r)}),n])}),Hn=jn(an),Kn=jn(sn),Qn=jn(function(n){return M(r.isArray,[N,t.elems,n])}),Un=jn(function(n){return M(r.isArray,[b,t.elems,n])}),Xn=jn(ln),Yn=jn(yn),Zn=jn(pn),$n=jn(dn),nr=jn(hn),rr=jn(function(n){return T([t.optional,n])}),tr=jn(vn),er=jn(mn),ur=jn(function(n){return n=W(n),function(r,t,e,u){return e.chain(function(n){return n?z(n)(r,t,e,u):o(e,r)},n(r,t))}}),ir=jn(An),or=jn(wn),cr=jn(c),fr=jn(gn),ar=jn(function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return gn(function(n){return sn.apply(null,r.map(function(r){return 2===f(r)?cn(un(r[0],r[1]),n):r[0]}))})}),sr=jn(function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return gn(function(n){return An.apply(null,r.map(H(n)))})}),lr=jn(function(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];return gn(function(r){return c.apply(null,[n].concat(t.map(H(r))))})});n.accept=On,n.acceptAs=Fn,n.acceptWith=bn,n.rejectWith=Nn,n.rejectAs=En,n.reject=xn,n.remove=In,n.run=zn,n.accepts=Mn,n.errors=Tn,n.validate=qn,n.acceptsAsync=Pn,n.errorsAsync=Rn,n.tryValidateAsyncNow=Vn,n.validateAsync=Wn,n.where=_n,n.modifyError=kn,n.setError=Cn,n.modifyAfter=Jn,n.setAfter=Ln,n.removeAfter=Sn,n.both=Bn,n.and=Dn,n.not=Gn,n.either=Hn,n.or=Kn,n.arrayId=Qn,n.arrayIx=Un,n.args=Xn,n.tuple=Yn,n.dependentFn=Zn,n.freeFn=$n,n.keep=nr,n.optional=rr,n.propsOr=tr,n.props=er,n.choose=ur,n.cases=ir,n.ifElse=or,n.casesOf=cr,n.lazy=fr,n.promote=ar,n.upgrades=sr,n.upgradesOf=lr,Object.defineProperty(n,"__esModule",{value:!0})});
