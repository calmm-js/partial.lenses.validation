!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses"],r):r(n.V={},n.I,n.L)}(this,function(n,c,a){"use strict";function r(n){this.value=void 0!==n?n:null}function f(n){var r=Error(JSON.stringify(n,null,2));return r.errors=n,r}function s(n){throw f(n)}function l(n,r){var t=q;return t===k?t=r:q=k,n.of(g(t))}function u(e){e=a.toFunction(e);var u=arguments.length-1;if(!u)return L;var n=arguments[u];1===n.length?(--u,n=x(n[0])):n=L;for(var c=Array(u),f=Array(u+1),r=0;r<u;++r){var t=arguments[r+1];c[r]=R(t[0]),f[r]=x(t[1])}return f[u]=n,function(n,r,i,t){var o=u;return e(n,r,a.Select,function(n,r){for(var t=0;t<o;++t){var e=c[t](n,r);if(e){if(0===(o=t))return 0;break}if(void 0===e&&q!==k){var u=q;return q=k,i.of(g(u))}}})||f[o](n,r,i,t)}}var o=function(n){return n.length},y=c.curry(function(n,r){return n<=r}),t=c.curry(function(n,r){return r instanceof n}),e=t(Object),p=c.curry(function(r,t){return function(n){return r(t(n))}}),d=c.curry(function(r,t){return function(n){return r(n)&&t(n)}}),i=function(n){},v=function(n){return n},h=function(n){return Promise.reject(n)},m=function(n){return Promise.resolve(n)},A=t(r),g=(0,c.id)(function(n){return new r(n)}),w=function(n){return n.value},j=function(n){return A(n)?w(n):void 0},O=function(r,t){return function(n){return a.any(A,r,n)?g(a.modify(r,t,n)):n}},I=a.rewrite(O(a.elems,function(n){return A(n)?w(n):null})),F=a.rewrite(O(a.elems,j)),b=a.rewrite(O(a.values,j)),N=function(n){return A(n)?s(f(w(n))):n},E=function(t,e,u){return v(function(){var n=arguments.length,r=t;if(n)for(r=e(arguments[--n],r);n;)r=u(arguments[--n],r);return r})},x=function(n){if(c.isFunction(n))return o(n)<3?$(n):n;var r=n[1];return c.isFunction(r)?nn(r,n[0]):rn(r,n[0])},z=function(n,r){return a.ifElse(n,M(r),L)},M=p(a.toFunction,a.modify(a.elems,x)),P=function(n){var r=n.less,e=n.rest;return e=x(e),function(){for(var i=arguments.length,t=Array(i),n=0;n<i;++n)t[n]=x(arguments[n]);return z(r?c.isArray:d(c.isArray,p(y(i),o)),[I,r?function(n,r,t,e){var u=o(n);return u<i?((n=n.slice()).length=i,t.map(function(n){return a.any(A,a.elems,n)?n:n.slice(0,u)},a.elemsTotal(n,r,t,e))):a.elemsTotal(n,r,t,e)}:a.elemsTotal,a.choose(function(n,r){return t[r]||e})])}},T=function(n,r,t){return G({Monad:n,onAccept:r,onReject:t})},k={},q=k,R=function(t,e){return function(n,r){try{return t(n,r)}catch(n){return q=n,e}}},S=a.zero,V=function(u){return function(n,r,t,e){return e(u,r)}},W=function(u){return function(n,r,t,e){return t.chain(function(n){return e(n,r)},u(n,r))}},_=function(u){return function(n,r,t,e){return t.map(g,u(n,r))}},J=p(a.setOp,g),L=a.modifyOp(g),B=V(void 0),C=function(t){return c.curryN(2,v(function(r){return r=x(r),function(n){return n=x(n),t(r,n)}}))},D=function(r){return function(n){return 3===o(n)?[n[0],on(tn(n[1],n[2]),r)]:n}},G=c.curryN(3,function(n){var t=n.Monad||a.Identity,r=n.onAccept||c.id,e=n.onReject||s,u=function(n){return A(n)?e(w(n)):r(n)};return function(r){return r=x(r),function(n){return t.chain(u,a.traverse(t,c.id,r,n))}}}),H=T(0,c.always(!0),c.always(!1)),K=T(0,i,c.id),Q=T(),U=T(a.IdentityAsync,c.always(m(!0)),c.always(m(!1))),X=T(a.IdentityAsync,c.always(m()),m),Y=T(a.IdentityAsync,0,p(s,f)),Z=T(a.IdentityAsync,m,p(h,f)),$=function(u){return u=R(u),function(r,n,t,e){return t.chain(function(n){return n?t.of(r):l(t,r)},u(r,n))}},nn=c.curry(function(u,i){return i=x(i),function(r,t,e,n){return e.chain(function(n){return A(n)?e.map(g,u(r,w(n),t)):e.of(n)},i(r,t,e,n))}}),rn=c.curry(function(r,n){return M([a.rewrite(function(n){return A(n)?g(r):n}),n])}),tn=c.curryN(2,function(n){return p(on(n),W)}),en=c.curryN(2,function(n){return p(on(n),V)}),un=function(n){return on(n,B)},on=C(function(u,i){return function(n,r,t,e){return t.chain(function(n){return A(n)?t.of(n):i(n,r,t,e)},u(n,r,t,e))}}),cn=E(S,x,on),fn=function(n){return M([a.setter(function(n,r){return A(n)?r:g(r)}),n])},an=C(function(n,i){return function(r,t,e,u){return e.chain(function(n){return A(n)?i(r,t,e,u):e.of(n)},n(r,t,e,u))}}),sn=E(L,x,an),ln=function(n){return z(c.isArray,[F,a.elems,n])},yn=function(n){return z(c.isArray,[I,a.elems,n])},pn=P({less:!0,rest:S}),dn=P({less:!1,rest:L}),vn=c.curry(function(i,o){return i=x(i),function(e,n,u,r){return u.of(c.isFunction(e)?v(function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return u.chain(function(r){return A(r)?s(f(w(r))):u.chain(function(n){return u.map(N,a.traverse(u,c.id,x(o.apply(null,r)),n))},e.apply(null,r))},a.traverse(u,c.id,i,r))}):g(e))}}),hn=c.curry(function(n,r){return vn(n,c.always(r))}),mn=c.curry(function(i,n){return z(e,[a.setter(function(n,r){return A(n)?g(a.set(i,(t=i,e=w(n),u=r,void 0!==(e=a.get(t,e))?e:a.get(t,u)),w(n))):n;var t,e,u}),n])}),An=function(n){return M([a.optional,n])},gn=c.curry(function(n,r){return z(e,[b,a.branchOr(x(n),a.modify(a.values,x,r))])}),wn=gn(L),jn=function(i){return i=R(i),v(function(n,r,t,e){var u=i(n,r);return u?x(u)(n,r,t,e):l(t,n)})},On=E(L,function(n,r){return 1===o(n)?n[0]:In(n[0],n[1],r)},function(n,r){return In(n[0],n[1],r)}),In=c.curry(function(i,o,c){return i=R(i),o=x(o),c=x(c),function(n,r,t,e){var u=i(n,r);return u?o(n,r,t,e):void 0!==u||q===k?c(n,r,t,e):l(t,n)}}),Fn=p(a.lazy,p(x)),bn=function(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];return Fn(function(r){return sn.apply(null,t.map(function(n){return 2===o(n)?on(tn(n[0],n[1]),r):n[0]}))})},Nn=function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return Fn(function(n){return On.apply(null,r.map(D(n)))})},En=function(r){for(var n=arguments.length,t=Array(1<n?n-1:0),e=1;e<n;e++)t[e-1]=arguments[e];return Fn(function(n){return u.apply(null,[r].concat(t.map(D(n))))})},xn=function(n){return n},zn=xn(S),Mn=xn(V),Pn=xn(W),Tn=xn(_),kn=xn(J),qn=xn(L),Rn=xn(B),Sn=xn(G),Vn=xn(H),Wn=xn(K),_n=xn(Q),Jn=xn(U),Ln=xn(X),Bn=xn(Y),Cn=xn(Z),Dn=xn($),Gn=xn(nn),Hn=xn(rn),Kn=xn(tn),Qn=xn(en),Un=xn(un),Xn=xn(on),Yn=xn(cn),Zn=xn(fn),$n=xn(an),nr=xn(sn),rr=xn(ln),tr=xn(yn),er=xn(pn),ur=xn(dn),ir=xn(vn),or=xn(hn),cr=xn(mn),fr=xn(An),ar=xn(gn),sr=xn(wn),lr=xn(jn),yr=xn(On),pr=xn(In),dr=xn(u),vr=xn(Fn),hr=xn(bn),mr=xn(Nn),Ar=xn(En);n.accept=zn,n.acceptAs=Mn,n.acceptWith=Pn,n.rejectWith=Tn,n.rejectAs=kn,n.reject=qn,n.remove=Rn,n.run=Sn,n.accepts=Vn,n.errors=Wn,n.validate=_n,n.acceptsAsync=Jn,n.errorsAsync=Ln,n.tryValidateAsyncNow=Bn,n.validateAsync=Cn,n.where=Dn,n.modifyError=Gn,n.setError=Hn,n.modifyAfter=Kn,n.setAfter=Qn,n.removeAfter=Un,n.both=Xn,n.and=Yn,n.not=Zn,n.either=$n,n.or=nr,n.arrayId=rr,n.arrayIx=tr,n.args=er,n.tuple=ur,n.dependentFn=ir,n.freeFn=or,n.keep=cr,n.optional=fr,n.propsOr=ar,n.props=sr,n.choose=lr,n.cases=yr,n.ifElse=pr,n.casesOf=dr,n.lazy=vr,n.promote=hr,n.upgrades=mr,n.upgradesOf=Ar,Object.defineProperty(n,"__esModule",{value:!0})});
