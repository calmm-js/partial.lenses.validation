!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses"],r):r(n.V={},n.I,n.L)}(this,function(n,c,f){"use strict";function r(n){this.value=void 0!==n?n:null}function a(n){var r=Error(JSON.stringify(n,null,2));return r.errors=n,r}function s(n){throw a(n)}function l(n,r){var t=R;return t===q?t=r:R=q,n.of(w(t))}function u(u){u=f.toFunction(u);for(var n=arguments.length,i=B;--n;){var r=arguments[n];i=1!==o(r)?D(V(r[0]),x(r[1]),i):c.always(x(r[0]))}return function(n,r,t,e){return u(n,r,f.Constant,i)(n,r,t,e)}}var o=function(n){return n.length},y=c.curry(function(n,r){return n<=r}),t=c.curry(function(n,r){return r instanceof n}),e=t(Object),p=c.curry(function(r,t){return function(n){return r(t(n))}}),d=c.curry(function(r,t){return function(n){return r(n)&&t(n)}}),i=function(n){},v=function(n){return n},h=function(n){return Promise.reject(n)},m=function(n){return Promise.resolve(n)},A=t(r),w=(0,c.id)(function(n){return new r(n)}),g=function(n){return n.value},j=function(n){return A(n)?g(n):void 0},O=function(r,t){return function(n){return f.any(A,r,n)?w(f.modify(r,t,n)):n}},I=f.rewrite(O(f.elems,function(n){return A(n)?g(n):null})),F=f.rewrite(O(f.elems,j)),N=f.rewrite(O(f.values,j)),b=function(n){return A(n)?s(a(g(n))):n},E=function(t,e,u){return v(function(){var n=arguments.length,r=t;if(n)for(r=e(arguments[--n],r);n;)r=u(arguments[--n],r);return r})},x=function(n){if(c.isFunction(n))return o(n)<3?rn(n):n;var r=n[1];return c.isFunction(r)?tn(r,n[0]):en(r,n[0])},z=function(n,r){return f.ifElse(n,M(r),L)},M=p(f.toFunction,f.modify(f.elems,x)),P=function(n){var r=n.less,e=n.rest;return e=x(e),function(){for(var i=arguments.length,t=Array(i),n=0;n<i;++n)t[n]=x(arguments[n]);return z(r?c.isArray:d(c.isArray,p(y(i),o)),[I,r?function(n,r,t,e){var u=o(n);return u<i?((n=n.slice()).length=i,t.map(function(n){return f.any(A,f.elems,n)?n:n.slice(0,u)},f.elemsTotal(n,r,t,e))):f.elemsTotal(n,r,t,e)}:f.elemsTotal,f.choose(function(n,r){return t[r]||e})])}},T=function(n,r,t){return K({Monad:n,onAccept:r,onReject:t})},q={},R=q,V=function(t,e){return function(n,r){try{return t(n,r)}catch(n){return R=n,e}}},W=f.zero,_=function(u){return function(n,r,t,e){return e(u,r)}},k=function(u){return function(n,r,t,e){return t.chain(function(n){return e(n,r)},u(n,r))}},C=function(u){return function(n,r,t,e){return t.map(w,u(n,r))}},J=p(f.setOp,w),L=f.modifyOp(w),S=_(void 0),B=c.always(L),D=function(n,c,f){return function(i,o){return function(r,t,e,u){return e.chain(function(n){return n?c(r,t,e,u):void 0!==n||R===q?f(i,o)(r,t,e,u):l(e,r)},n(i,o))}}},G=function(t){return c.curryN(2,v(function(r){return r=x(r),function(n){return n=x(n),t(r,n)}}))},H=function(r){return function(n){return 3===o(n)?[n[0],fn(un(n[1],n[2]),r)]:n}},K=c.curryN(3,function(n){var t=n.Monad||f.Identity,r=n.onAccept||c.id,e=n.onReject||s,u=function(n){return A(n)?e(g(n)):r(n)};return function(r){return r=x(r),function(n){return t.chain(u,f.traverse(t,c.id,r,n))}}}),Q=T(0,c.always(!0),c.always(!1)),U=T(0,i,c.id),X=T(),Y=T(f.IdentityAsync,c.always(m(!0)),c.always(m(!1))),Z=T(f.IdentityAsync,c.always(m()),m),$=T(f.IdentityAsync,0,p(s,a)),nn=T(f.IdentityAsync,m,p(h,a)),rn=function(u){return u=V(u),function(r,n,t,e){return t.chain(function(n){return n?t.of(r):l(t,r)},u(r,n))}},tn=c.curry(function(u,i){return i=x(i),function(r,t,e,n){return e.chain(function(n){return A(n)?e.map(w,u(r,g(n),t)):e.of(n)},i(r,t,e,n))}}),en=c.curry(function(r,n){return M([f.rewrite(function(n){return A(n)?w(r):n}),n])}),un=c.curryN(2,function(n){return p(fn(n),k)}),on=c.curryN(2,function(n){return p(fn(n),_)}),cn=function(n){return fn(n,S)},fn=G(function(u,i){return function(n,r,t,e){return t.chain(function(n){return A(n)?t.of(n):i(n,r,t,e)},u(n,r,t,e))}}),an=E(W,x,fn),sn=function(n){return M([f.setter(function(n,r){return A(n)?r:w(r)}),n])},ln=G(function(n,i){return function(r,t,e,u){return e.chain(function(n){return A(n)?i(r,t,e,u):e.of(n)},n(r,t,e,u))}}),yn=E(L,x,ln),pn=function(n){return z(c.isArray,[F,f.elems,n])},dn=function(n){return z(c.isArray,[I,f.elems,n])},vn=P({less:!0,rest:W}),hn=P({less:!1,rest:L}),mn=c.curry(function(i,o){return i=x(i),function(e,n,u,r){return u.of(c.isFunction(e)?v(function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return u.chain(function(r){return A(r)?s(a(g(r))):u.chain(function(n){return u.map(b,f.traverse(u,c.id,x(o.apply(null,r)),n))},e.apply(null,r))},f.traverse(u,c.id,i,r))}):w(e))}}),An=c.curry(function(n,r){return mn(n,c.always(r))}),wn=c.curry(function(i,n){return z(e,[f.setter(function(n,r){return A(n)?w(f.set(i,(t=i,e=g(n),u=r,void 0!==(e=f.get(t,e))?e:f.get(t,u)),g(n))):n;var t,e,u}),n])}),gn=function(n){return M([f.optional,n])},jn=c.curry(function(n,r){return z(e,[N,f.branchOr(x(n),f.modify(f.values,x,r))])}),On=jn(L),In=function(n){return n=V(n),v(function(r,t,e,u){return e.chain(function(n){return n?x(n)(r,t,e,u):l(e,r)},n(r,t))})},Fn=E(L,function(n,r){return 1===o(n)?n[0]:Nn(n[0],n[1],r)},function(n,r){return Nn(n[0],n[1],r)}),Nn=c.curry(function(n,i,o){return n=V(n),i=x(i),o=x(o),function(r,t,e,u){return e.chain(function(n){return n?i(r,t,e,u):void 0!==n||R===q?o(r,t,e,u):l(e,r)},n(r,t))}}),bn=p(f.lazy,p(x)),En=function(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];return bn(function(r){return yn.apply(null,t.map(function(n){return 2===o(n)?fn(un(n[0],n[1]),r):n[0]}))})},xn=function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return bn(function(n){return Fn.apply(null,r.map(H(n)))})},zn=function(r){for(var n=arguments.length,t=Array(1<n?n-1:0),e=1;e<n;e++)t[e-1]=arguments[e];return bn(function(n){return u.apply(null,[r].concat(t.map(H(n))))})},Mn=function(n){return n},Pn=Mn(W),Tn=Mn(_),qn=Mn(k),Rn=Mn(C),Vn=Mn(J),Wn=Mn(L),_n=Mn(S),kn=Mn(K),Cn=Mn(Q),Jn=Mn(U),Ln=Mn(X),Sn=Mn(Y),Bn=Mn(Z),Dn=Mn($),Gn=Mn(nn),Hn=Mn(rn),Kn=Mn(tn),Qn=Mn(en),Un=Mn(un),Xn=Mn(on),Yn=Mn(cn),Zn=Mn(fn),$n=Mn(an),nr=Mn(sn),rr=Mn(ln),tr=Mn(yn),er=Mn(pn),ur=Mn(dn),ir=Mn(vn),or=Mn(hn),cr=Mn(mn),fr=Mn(An),ar=Mn(wn),sr=Mn(gn),lr=Mn(jn),yr=Mn(On),pr=Mn(In),dr=Mn(Fn),vr=Mn(Nn),hr=Mn(u),mr=Mn(bn),Ar=Mn(En),wr=Mn(xn),gr=Mn(zn);n.accept=Pn,n.acceptAs=Tn,n.acceptWith=qn,n.rejectWith=Rn,n.rejectAs=Vn,n.reject=Wn,n.remove=_n,n.run=kn,n.accepts=Cn,n.errors=Jn,n.validate=Ln,n.acceptsAsync=Sn,n.errorsAsync=Bn,n.tryValidateAsyncNow=Dn,n.validateAsync=Gn,n.where=Hn,n.modifyError=Kn,n.setError=Qn,n.modifyAfter=Un,n.setAfter=Xn,n.removeAfter=Yn,n.both=Zn,n.and=$n,n.not=nr,n.either=rr,n.or=tr,n.arrayId=er,n.arrayIx=ur,n.args=ir,n.tuple=or,n.dependentFn=cr,n.freeFn=fr,n.keep=ar,n.optional=sr,n.propsOr=lr,n.props=yr,n.choose=pr,n.cases=dr,n.ifElse=vr,n.casesOf=hr,n.lazy=mr,n.promote=Ar,n.upgrades=wr,n.upgradesOf=gr,Object.defineProperty(n,"__esModule",{value:!0})});
